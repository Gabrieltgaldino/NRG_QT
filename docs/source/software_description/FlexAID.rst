.. _FlexAID:

FlexAID
=======
Settings
---------

**FlexAID** (https://pubs.acs.org/doi/10.1021/acs.jcim.5b00078) is a docking algorithm that can dock small molecules and peptides to targets such as proteins or nucleic acids.

.. note::

    To run FlexAID, the ligand, the target, and the target cleft (see :doc:`GetCleft`) must be loaded into Pymol beforehand.

Click on the 'FlexAID' button in the main menu on the left side of the plugin interface.

In the 'Settings' tab, set the 'Number of Generations' and 'Number of Chromosomes' for the FlexAID genetic algorithm.

    .. note::

        We recommend increasing the 'Number of Generations' and 'Number of Chromosomes' from the default 500/500 to 1000/1000 or even 2000/2000 (this may take more than 30 minutes on certain laptops) for large binding pockets and large flexible ligands.

    .. image:: /_static/images/Flexaid/flexaid_settings.png
           :alt: An example image
           :width: 65%
           :align: center

Mark the "Ligand pose as reference" box to calculate the RMSD between FlexAID results and the original ligand pose.

Simulate
-------------

In the 'Simulate' tab, press the 'Refresh' button for the target and ligand.

By default the list of binding sites loaded in Pymol in the group "GetCleft" in the sub group with same name as the target will show up (see :doc:`GetCleft` outputs).

.. note::
    In order to allow custom binding sites loaded in Pymol outside the group generated by "GetCleft", mark "Show all binging sites" in the settings menu :doc:`Settings`.

The white box will display the path to the results folder once the simulation is complete.

    .. image:: /_static/images/Flexaid/flexaid_simulate.png
           :alt: An example image
           :width: 65%
           :align: center

Press the 'Start' button to begin the simulation, and the 'Results' tab will open automatically.

The 'Progress Bar' will indicate how many generations have passed in the genetic algorithm. The 'Pause' button can be used to temporarily stop a simulation and resume it later without closing the plugin interface. The 'Stop' button will halt the simulation and save the results as they are for the current generation. The 'Abort' button will stop the simulation without saving any results.

Results are shown for the top 10 poses. The 'CF' column indicates the scoring for each pose (a more negative CF indicates a better score) and column "Last RMSD" shows the RMSD to the original ligand pose.

    .. image:: /_static/images/Flexaid/flexaid_result.png
           :alt: An example image
           :width: 100%
           :align: center

The top 10 results are loaded into the Pymol interface and updated in real-time during the simulation.
