.. _FlexAID:

FlexAID
=======

FlexAID (https://pubs.acs.org/doi/10.1021/acs.jcim.5b00078) is a docking algorithm that can use small molecules and peptides as ligands and proteins or nucleic acids as targets.

.. note::

    To run FlexAID, the ligand, the target, and the target cleft must be loaded in PyMOL beforehand.

Click on the 'FlexAID' button in the main menu on the left side of the plugin interface. In the 'Settings' tab, set the 'Number of generations' and 'Number of chromosomes' for the FlexAID genetic algorithm. We recommend increasing the 'Number of generations' and 'Number of chromosomes' from the default 500/500 to 1000/1000 or even 2000/2000 (this may take more than 30 minutes on certain laptops) for large binding pockets and large ligands.

    .. image:: /_static/images/Flexaid/flexaid_settings.png
           :alt: An example image
           :width: 65%
           :align: center

In the 'Simulate' tab, press the 'Refresh' button for the target, ligand, and bind-site lists, and select the target, ligand, and cleft (generated by :doc:`GetCleft`) objects.

The button 'Retrieve NRGDock ligands' should be used if :doc:`Surfaces` was previously run for one of the :doc:`NRGdock` results and the ligand objects ended up being removed from PyMOL.

The white box will display the path to the results folder once the simulation is complete.

    .. image:: /_static/images/Flexaid/flexaid_simulate.png
           :alt: An example image
           :width: 65%
           :align: center

Press the 'Start' button to begin the simulation, and the 'Results' tab will open automatically.

The 'Progress bar' will indicate how many generations have passed in the genetic algorithm. The 'Pause' button can be used to stop a simulation temporarily and resume it later without closing the plugin interface. The 'Stop' button will halt the simulation and save the results as they are for the current generation. The 'Abort' button will stop the simulation without saving any results.

The scores for the top 5 poses are shown under the buttons. The 'CF' is the scoring for the pose (a more negative CF indicates a better score).

    .. image:: /_static/images/Flexaid/flexaid_result.png
           :alt: An example image
           :width: 65%
           :align: center

The top 10 results are loaded in the PyMOL interface and updated in real-time during the simulation.
