===============================================
Eph4 drug repurposing (Ligand-Protein analysis)
===============================================

In this tutorial, we will reproduce the results of Gu S. et al. 2018 (https://www.nature.com/articles/s41598-018-25790-1). In their work, they searched a dataset of FDA-approved drugs for inhibitors of the receptor tyrosine kinase erythropoietin-producing hepatocellular A4 (EphA4). This receptor was identified as a molecular target for Alzheimer’s disease (AD). They selected and tested 22 molecules and found 5 potential inhibitors of EphA4. Specifically, nilotinib (https://go.drugbank.com/drugs/DB04868), a kinase inhibitor, inhibited the binding of EphA4 and ephrin-A at a micromolar scale in a dose-dependent manner. In this tutorial, we are going to use a structure of EphA4 (PDB code: 2wo2, https://www.rcsb.org/structure/2WO2), the same structure Gu S. et al. used in their work.

.. _Eph4 drug repurposing (Ligand-Protein analysis):

Preparing the Target
====================

Open PyMOL and run the command:

    .. code-block:: console

            fetch 2wo2

    .. image:: /_static/images/Tutorial/fetch_2wo2.png
           :alt: An example image
           :width: 65%
           :align: center



The structure of the target should appear in the PyMOL window.
We now follow the preparation steps for docking, removing the EPHRIN-B2 chain and water molecules.
Run the commands:

    .. code-block:: console

        remove chain B
        remove solvent

    .. image:: /_static/images/Tutorial/prep_2wo2.png
           :alt: An example image
           :width: 65%
           :align: center



Defining Binding Site Area of EphA4
===================================

Open the NRGSuite-Qt plugin from the PyMOL plugin menu and click on the button 'GetCleft' (see :doc:`GetCleft`). Click 'Refresh', select '2wo2', and press 'Play'.

    .. image:: /_static/images/Tutorial/get_cleft_2wo2.png
           :alt: An example image
           :width: 65%
           :align: center

Five clefts should load in the PyMOL interface.
The cleft with the largest volume, '2wo2_bd_site_1', is the one we will use for our docking experiments.

    .. image:: /_static/images/Tutorial/clefts_view.png
           :alt: An example image
           :width: 65%
           :align: center


Running the FDA-Approved-Drugs Ligand Set on EphA4
======================================================================================================

In the plugin interface, click the 'NRGRank' button in the left corner. Go to the 'Settings' tab.

Set the number of 'Save poses for top n results' to 20 (so we can have the structures of the top 20 molecules). We expect that nilotinib (code: DB04868), the inhibitor identified in the paper, will be ranked among the best-scored ligands of the 'DrugBank FDA' ligand set, so it should appear among the top 20 ligands.

The ligand rotations will remain at 9 (default). The user can choose how much of CPU usage to allow, we recommend to use the default (75%).

    .. image:: /_static/images/Tutorial/NRGRank_settings.png
           :alt: An example image
           :width: 65%
           :align: center

Click the 'Run' tab. Press 'Refresh' on the target list and select '2wo2'. Press 'Refresh' in the 'Binding site' list and select '2wo2_bd_site_1'. Press 'Run' and wait until the progress bar is full.

    .. image:: /_static/images/Tutorial/NRGRank_run.png
           :alt: An example image
           :width: 65%
           :align: center



The top 20 ligands will be plotted in the PyMOL interface in a group called 'results_NRGDock'. Search for 'DB04868'—this is the pose generated by NRGRank.

    .. image:: /_static/images/Tutorial/NRGRank_results_list.png
           :alt: An example image
           :width: 65%
           :align: center


You can access the complete list of results of NRGRank by opening the '.csv' file in the 'temp' directory of 'NRGsuite_QT' in documents.


To obtain a more realistic pose of the nilotinib/EphA4 complex, we will re-do the docking simulation for nilotinib using FlexAID.

Performing Docking of Nilotinib Using FlexAID
=============================================

Click the 'FlexAID' button in the left corner menu. Go to the 'Settings' tab. Set the 'Number of chromosomes' to 500 and 'Number of generations' to 500. Check the box 'Ligand pose as reference' to compare FLEXAID and NRGDock poses.

    .. image:: /_static/images/Tutorial/flexaid_config.png
           :alt: An example image
           :width: 65%
           :align: center

Go to the 'Simulate' tab. Press 'Refresh' in the target list, ligand list, and bind-site list. Select '2wo2' as the target, 'DB04868' as the ligand, and 'receptor_sph_1' as the target cleft.

    .. image:: /_static/images/Tutorial/flexaid_simulation.png
           :alt: An example image
           :width: 65%
           :align: center

The 'Results' tab will open automatically. The progress bar will indicate the progress of the simulation and list the top 5 best ligand poses and their scores (CF, most negative -> better scoring).

    .. image:: /_static/images/Tutorial/flexaid_resulttable.png
           :alt: An example image
           :width: 65%
           :align: center

The top 10 results will be plotted in the PyMOL interface in a group called Flexaid results:

    .. image:: /_static/images/Tutorial/flexaid_results_view.png
           :alt: An example image
           :width: 65%
           :align: center



Visualizing Nilotinib/EphA4 Interactions with Surfaces
======================================================

We will now run the Surfaces for the top pose of FLEXAID.
Make a selection for the ligand:

    .. code-block:: console

        select Ligand, resn LIG and Result_0

Click the 'Surfaces' button in the menu. Click in 'Refresh' on the 'Surfaces selection:' area and select 'Result_0'. Press 'Run Surfaces'. Select 'Ligand' in the 'Ligand:' list and press 'Run'


    .. image:: /_static/images/Tutorial/surfaces_run_lig.png
           :alt: An example image
           :width: 65%
           :align: center

A table with all surfaces results can be seen in the tab 'Results', press 'Refresh' to list all individual results. Select: 'List_RESULT_0_csv_output'.

    .. image:: /_static/images/Tutorial/surfaces_result_table.png
           :alt: An example image
           :width: 65%
           :align: center

A list view of all interactions is shown in the PyMOL interface in a group named: "surfaces_results". The table in 'Results' table is interactive. Individual residues can be selected by clicking the result name. A selection named:'sele_surefaces' is created with that specific residue.

    .. image:: /_static/images/Tutorial/surfaces_result_view.png
           :alt: An example image
           :width: 100%
           :align: center

Click on PHE154A int the result table and Run the command:

    .. code-block::

        set_name sele_surfaces, PHE154A

a selection containing the residue F154 will be created.

In the article the authors say: 'Nilotinib is predicted to form hydrogen bonds with Q71 in the D-E loop and T104 as well as hydrophobic interactions with F154, V157, I163, L166, A193, and V195.'
Also, we can create a selection with the Top N residues by interection absolute value. Type 10 in the 'TOP N residues:' field and press the button 'Interface'. A selection called 'all_residues' is created.


Analysing Nilotinib/EphA4 with Normal Mode Analysis
===================================================

We can now run calculate the dynamical signature for the complex using NRGTEN. In 'NRGTEN' menu, in the 'Load object' area press 'Refresh'. Select 'RESULT_O' the 'Object:' list and 'Ligand' in the ligand 'List'. In the Dynamical Signature area write 1 in the 'Beta' field and press 'Run'.

    .. image:: /_static/images/Tutorial/NRGTEN_dynasig_config.png
           :alt: An example image
           :width: 65%
           :align: center

A object called 'RESULT_0_dynasig' will show a fluctuation plot in the structure. Blue residues are more rigid while Red residues are more flexible. Also, another object 'no_lig_RESULT_0_dynasig' will be plotted showing the difference between the dynamical signature of EphA4 in presence and absence of ligand.

    .. image:: /_static/images/Tutorial/NRGTEN_dynasigview.png
           :alt: An example image
           :width: 100%
           :align: center

We can also generate a dynamical ensemble of EphA4. Type '7' in the 'modes list:' field and select 'optimize states' to generate a conformation ensemble using the first non trivial normal mode. An object named 'RESULT_0_ensemble' containing the optimized conformational ensemble will be created.

    .. image:: /_static/images/Tutorial/NRGTEN_ensembleview.png
           :alt: An example image
           :width: 100%
           :align: center

Generating Nilotinib/EphA4 mutants with MODELLER.
=================================================

We now want to generate single mutants of EphA4 in the position 154 to see changes in the binding energy using Surfaces and in the complex flexibility using NRGTEN.
Open the 'MODELLER' menu. Press "Refresh" and select 'Result_0' in the 'Object to mutate' and 'PHE154A' in the 'Selected residues(s):' list. Then mark 'ALL' in single mutations area.

    .. image:: /_static/images/Tutorial/tutorial_modeller_config.png
           :alt: An example image
           :width: 65%
           :align: center

An object called 'Result_0_mutants' show be created. Each of the 19 single mutants will be loaded as a state in this object.
Create a selection for the ligand in this new object:

    .. code-block::

        select Ligand_mutants, resn LIG and Result_0_mutants

Analysing the effect of mutations in the interactions Nilotinib/EphA4 with Surfaces.
====================================================================================

Open 'Surfaces' menu. Press button 'Refresh' in 'Surfaces selection:'. In 'Object:' list select 'Result_0' and 'Ligand' in the ligand list.
Now press 'Refresh' in 'Surfaces selection 2:' area. Select 'Result_0_mutants' in 'Object2:' list and 'Ligand_mutants' in the ligand list. Then press 'Run Surfaces'.


    .. image:: /_static/images/Tutorial/surfaces_mutants_config.png
           :alt: An example image
           :width: 65%
           :align: center

A list of CF of each mutant will be plotted in the tab 'Results'. The individual results for each mutant can be select in the 'individual results:' list.

    .. image:: /_static/images/Tutorial/surfaces_mutants_results.png
           :alt: An example image
           :width: 100%
           :align: center

A positive CF means that the biding is reduced in that mutant.

Analysing the effect of mutations in the flexibility of Nilotinib/EphA4 complex with NRGTEN
===========================================================================================

Open the 'NRGTEN' menu. Select 'RESULT_0' in the object list in the 'load object' menu. Select 'RESULT_0_mutants' in the 'Object 2' list. Press run in the dynamical signature menu.


    .. image:: /_static/images/Tutorial/nrgten_config_mutants.png
           :alt: An example image
           :width: 65%
           :align: center

A html. file will open showing the difference between the dynamical signature of the wildtype and the mutants. Also the differential will be plotted to the structure in PyMOL window in a group off objects called 'RESULT_0_mutants_dynasigdif'.

    .. image:: /_static/images/Tutorial/nrgten_graphic_plot_mutants.png
           :alt: An example image
           :width: 75%
           :align: center

    .. image:: /_static/images/Tutorial/nrgten_pymol_res_mutants.png
           :alt: An example image
           :width: 75%
           :align: center


Binding-site comparison between EphA4 and ABL kinase using ISOMIF
=================================================================

A structure of ABL kinase in complex with Nalotinib is available in PDB (https://www.rcsb.org/structure/3cs9). We can use ISOMIF to compare both binding sites of EphA4 and ABL using molecular interaction field to identify geographically and chemically equivalent areas of their binding sites. This can give us an idea of how Nalotinib is capable of biding both proteins and what are the chemical properties important for this process.

To download and make a selection with the ligand in 3cs9, run these commands in PyMOL:

    .. code-block::

        fetch 3cs9, type=pdb1
        remove solvent
        select Ligand_3cs9, resn NIL and 3cs9

Open 'GetCleft' menu. Select 3cs9 in the 'PyMOL objects/selections:' list and press 'start'.

    .. image:: /_static/images/Tutorial/ISOMIF_getcleft_config.png
           :alt: An example image
           :width: 65%
           :align: center

The first cleft will be the one containing the ligand in 3cs9. We can now open ISOMIF menu and in the "Load object 1" area select "3cs9" in "Object 1" list, "3cs9_sph_1" in the "Cleft" list and "Ligand_3cs9" in "LIG" list.
In the "Load object 2" area select RESULT_0 in the "Object 2" list, "RESULT_0_sph_1" in the "Cleft" list and "Ligand" list.
Press "Run".

    .. image:: /_static/images/Tutorial/ISOMIF_config.png
           :alt: An example image
           :width: 65%
           :align: center


